name: Build Windows Executable

on:
  push:
    tags:
      - "v*.*.*" # v1.0.0, v2.1.3 ë“±ì˜ íƒœê·¸ê°€ í‘¸ì‹œë  ë•Œ
  workflow_dispatch: # ìˆ˜ë™ìœ¼ë¡œë„ ì‹¤í–‰ ê°€ëŠ¥

env:
  APP_NAME: ë„¤ì´ë²„ë¸”ë¡œê·¸ìë™í¬ìŠ¤íŒ…
  PYTHON_VERSION: "3.9"

jobs:
  build:
    name: Build Windows .exe
    runs-on: windows-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: ${{ env.PYTHON_VERSION }}

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install PyQt5==5.15.7
          pip install selenium==4.11.2
          pip install openai==1.3.5
          pip install requests==2.31.0
          pip install pytz==2023.3
          pip install pyinstaller==5.13.2

      - name: Build executable
        run: |
          echo "ğŸš€ PyInstallerë¡œ .exe íŒŒì¼ ìƒì„± ì¤‘..."
          pyinstaller main.spec

          echo "ğŸ“‹ ë¹Œë“œ ê²°ê³¼ í™•ì¸:"
          dir dist\

          echo "âœ… .exe íŒŒì¼ ìƒì„± ì™„ë£Œ!"
          if (Test-Path "dist\ë„¤ì´ë²„ë¸”ë¡œê·¸ìë™í¬ìŠ¤íŒ….exe") {
            echo "âœ… .exe íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!"
            dir "dist\ë„¤ì´ë²„ë¸”ë¡œê·¸ìë™í¬ìŠ¤íŒ….exe"
          } else {
            echo "âŒ .exe íŒŒì¼ ìƒì„± ì‹¤íŒ¨!"
            exit 1
          }

      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: naver-blog-automation
          path: dist/ë„¤ì´ë²„ë¸”ë¡œê·¸ìë™í¬ìŠ¤íŒ….exe

      - name: Build Success Notification
        run: |
          echo "ğŸ‰ ë¹Œë“œê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"
          echo "ğŸ“¦ .exe íŒŒì¼ì´ ì•„í‹°íŒ©íŠ¸ì— ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤."
          echo ""
          echo "ğŸ“¥ ë‹¤ìš´ë¡œë“œ ë°©ë²•:"
          echo "1. GitHub Actions í˜ì´ì§€ì—ì„œ ì´ ë¹Œë“œ í´ë¦­"
          echo "2. 'Artifacts' ì„¹ì…˜ì—ì„œ 'naver-blog-automation' ë‹¤ìš´ë¡œë“œ"
          echo "3. ì••ì¶• í•´ì œí•˜ì—¬ 'ë„¤ì´ë²„ë¸”ë¡œê·¸ìë™í¬ìŠ¤íŒ….exe' ì‹¤í–‰"
          echo ""
          echo "ğŸ”— ì§ì ‘ ë§í¬: https://github.com/${{ github.repository }}/actions"
          echo ""
          echo "âœ¨ ì£¼ìš” ê¸°ëŠ¥:"
          echo "- ë‹¤ì¤‘ ë„¤ì´ë²„ ê³„ì • ì§€ì›"
          echo "- AI ì½˜í…ì¸  ìƒì„± (OpenAI ì—°ë™)"
          echo "- ì •í™•í•œ ì˜ˆì•½ ë°œí–‰"
          echo "- ìë™ íƒœê·¸ ê´€ë¦¬"
          echo "- ë°œí–‰ëœ ê²Œì‹œë¬¼ URL ìë™ ìˆ˜ì§‘"
          echo ""
          echo "ğŸ’» ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­: Windows 7/10/11 (64ë¹„íŠ¸)"
          echo "âš ï¸ ì£¼ì˜: ì²« ì‹¤í–‰ ì‹œ Windows Defender ê²½ê³  ì •ìƒ"
